<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="generator" content=
    "HTML Tidy for Windows (vers 14 February 2006), see www.w3.org" />
    <title>
      WatiN Documentation
    </title>
    <meta content="http://schemas.microsoft.com/intellisense/ie5" name=
    "vs_targetSchema" />
    <meta content="watin, test, C#, web, .Net, framework, html, dom, watir"
    name="Keywords" />
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <meta content="Global" name="Distribution" />
    <meta content="Jeroen van Menen" name="Author" />
    <meta content="index,follow" name="Robots" />
    <link href="images/BrightSide.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <!-- wrap starts here -->
    <div id="wrap">
      <div id="header">
        <h1 id="logo">
          <span class="green"><font color="#6297BC">WatiN</font></span>
        </h1>
        <h2 id="slogan">
          Web Application Testing In .Net
        </h2>
		<!-- Menu Tabs -->
        <ul>
          <li>
            <a href="index.html"><span>Home</span></a>
          </li>
          <li>
            <a href=
            "http://sourceforge.net/project/showfiles.php?group_id=167632"><span>
            Downloads</span></a>
          </li>
          <li id="current">
            <a href="documentation.html"><span>Documentation</span></a>
          </li>
          <li>
            <a href="contribute.html"><span>Contribute</span></a>
          </li>
          <li>
            <a href="support.html"><span>Support</span></a>
          </li>
          <li>
            <a href=
            "http://sourceforge.net/export/rss2_project.php?group_id=167632"><span>
            RSS</span></a>
          </li>
        </ul>
      </div><!-- content-wrap starts here -->
      <div id="content-wrap">
        <div id="main">
          <h1>
            Getting <span class="green">started</span> <span class=
            "gray">with</span> WatiN
          </h1>
          <p>
            This article explains some of the basics to get you up and running
            to automate your web applications with WatiN. A German version is
            also available <a target="_blank" href=
            "http://blogs.dotnetgerman.com/alexonasp.net/PermaLink,guid,03b01395-6318-4c14-8158-a38adaa8f4bc.aspx">
            here</a>.
          </p><br />
          <p>
            <strong>Index</strong>
          </p>
          <ol>
            <li>
              <span>Download and install WatiN.</span>
            </li>
            <li>
              <span>Using WatiN from a console application.</span>
            </li>
            <li>
              <span>Using IE Developer Toolbar with WatiN.</span>
            </li>
          </ol><br />
          <p>
            <strong>Download and install WatiN</strong>
          </p>
          <p>
            If you haven't already done this, you should download the latest release of WatiN
			<a href="http://sourceforge.net/project/showfiles.php?group_id=167632">WatiN</a>.
            Alternatively you could get the latest source from the <a href=
            "http://sourceforge.net/svn/?group_id=167632">Subversion
            repository</a> (using <a href="http://tortoisesvn.tigris.org/"
            target="_blank">TortoiseSVN</a>) and build it yourself.
            After you downloaded the version run the installer or Unzip the 
			download in a directory. Lets assume you used the msi installer,
			then WatiN will be installed in c:\Program Files\WatiN\&lt;version&gt;-&lt;.net version&gt;
          </p>
		  <br>
          <p>
            <strong>Using WatiN from a console application</strong>
          </p>
		  <p>
		    Start your favourite .Net ide. In this example I will use
            Visual Studio 2003. Create a new console application named WatiNGettingStarted.
		    Next, add a reference to WatiN.Core.dll by opening the Add Reference
            dialog and selecting the assembly from the WatiN installation directory.
          </p>
          <p>
            <img border="0" width="607" height="455" src=
            "gettingstarted_bestanden/image009.jpg" />
          </p>
          <p>
            <img border="0" width="607" height="455" src=
            "gettingstarted_bestanden/image010.jpg" /> 
          </p>
          <br>
		  <p>
            Rename the file Class1.cs to WatinConsoleExample.cs and replace
            the existing code with the following code. This code will:<br />
              <ol>
                <li><span>Open a new Internet Explorer window and go to the
                Google.com website (it might be redirected to a localised
                version).</span>
                <li><span>Type the text WatiN in the search text field which can be
                uniquely identified in the html code by the name q.
                </span>
                <li><span>Click the search button which can be uniquely identified by
                the text Google Search (this is the value attribute of the html
                input element).</span>
                </li>
              </ol>
          </p>		  
          <p>
		  <code>
            using System;<br>
            using WatiN.Core;<br>
			<br>
            namespaceWatiNGettingStarted<br>
            {<br>
              class WatiNConsoleExample<br>
              {<br>
                [STAThread]<br>
                static void Main(string[] args)<br>
                {<br>
                  // Open a new Internet Explorer window and<br>
                  // goto the google website.<br>
                  IE ie = new IE("http://www.google.com");<br>
				  <br>
                  // Find the search text field and type Watin in it.<br>
                  ie.TextField(Find.ByName("q")).TypeText("WatiN");<br>
				  <br>
                  // Click the Google search button.<br>
                  ie.Button(Find.ByValue("Google Search")).Click();<br>
             	  <br>
                  // Uncomment the following line if you want to close<br>
                  // Internet Explorer and the console window immediately.<br>
                  //ie.Close();<br>
                }<br>
              }<br>
            }<br>
          </code>   
          </p>
          <p>
		  Build and start the project and see Internet Explorer go to the
            Google website, search for WatiN and finally show the results
            webpage.
          </p>
		  <br>
          <p>
            <strong>Using IE Developer Toolbar with WatiN</strong>
          </p>
          <p>
            Lets make this example a bit more interesting by writing the
            results statistics to the console window.
          </p>
          <p>
            First we need to find out how we can get this information from the
            Google results webpage by using WatiN. Lets inspect the webpage
            with the <a href=
            "http://www.microsoft.com/downloads/details.aspx?FamilyID=e59c3964-672d-4511-bb3e-2d5e1db91038&amp;displaylang=en"
            target="_blank">Internet Explorer Developer toolbar</a> (this is a
            must have if you want to do serious web automation!).
          </p>
          <p>
            <img border="0" width="607" height="455" src=
            "gettingstarted_bestanden/image011.jpg" />
          </p>
		  <br>
          <p>
            After opening the Dom Explorer with the View DOM button from the
            DevToolBar, select Select element by click in the Find menu and
            click on the results table cell on the webpage. The DOM Explorer
            then shows where the table cell is located in the DOM hierarchy
            (see screenshot).
          </p>
          <p>
            Since the results table cell hasnt a unique identifier, like an Id
            or name, we cant get a reference to the table cell in an easy way.
            We need to use the hierarchy of the html elements in the page to
            get to the results table cell. First lets concentrate on finding
            the table the results table cell is located in. The table is the
            third table so we could use the Table collection to get a reference
            to this table. The code would look like this:
          </p>
          <p>
          <code>
            Table table = ie.Tables[2];
          </code>
          </p>
          <p>
            There is another way to get this same table, using the classname of
            this Table. Since no other table has the classname t assigned to
            it, this makes it unique to the table we are looking for. To find
            this table by its classname we will use the Find.By factory
            method like this:
          </p>
          <p>
		  <code>
            Table table = ie.Table(Find.By("classname","t"));
          </code>
          <p>
            At this point we have a reference to the table the results
            statistics are in. Next, find the table row and table cell the
            actual info is located in. 
          </p>
          <p>
			Finding the right table row is simple,
            there is only one row (&lt;TR&gt;) in this table. To get the
            results table cell we will use the TableCells collection. The text
            in the second table cell (&lt;TD&gt;) contains the info we are
            looking for. This results in the following code:
          </p>
          <p>
		  <code>
            string resultStats = table.TableRows[0].TableCells[1].Text;
          </code>
		  </p>
          <p>
            The last thing we have to do is write this info to the Console
            window. And here is the final code for this example.
          </p>
		  <p>
		  <code>
		    using System;<br>
            using WatiN.Core;<br>
<br>
            namespaceWatiNGettingStarted<br>
            {<br>
              class WatiNConsoleExample<br>
              {<br>
                [STAThread]<br>
                static void Main(string[] args)<br>
                {<br>
                  // Open an new Internet Explorer Window and<br>
                  // goto the google website.<br>
                  IE ie = new IE("http://www.google.com");<br>
             <br>
                  // Find the search text field and type Watin in it.<br>
                  ie.TextField(Find.ByName("q")).TypeText("WatiN");<br>
<br>
                  // Click the Google search button.<br>
                  ie.Button(Find.ByValue("Google Search")).Click();<br>
             <br>
                  // Find the table cell which shows the search result statistics.<br>
                  Table table = ie.Table(Find.By("classname","t"));<br>
                  string resultStats = table.TableRows[0].TableCells[1].Text;<br>
             <br>
                  // Write these statistics to the console window.<br>
                  Console.WriteLine(resultStats);<br>
             <br>
                  // Uncomment the following line if you want to close<br>
                  // Internet Explorer and the console window immediately.<br>
                  //ie.Close();<br>
                }<br>
              }<br>
            } <br>
		  </code> 
          </p>
          <p>
            Build and start the project and youll see something like this:
          </p>
          <p>
            <img border="0" width="607" height="455" src=
            "gettingstarted_bestanden/image012.jpg" v:shapes="_x0000_i1028" />
          </p>
		  <br>
          <p>
            <strong>And now its up to you. Enjoy testing with WatiN!</strong>
          </p>
		  <br>
        </div>
        <div id="rightbar">
          <div id="sidebar">
            <h1>
              Quick <span class="green">Links</span>
            </h1>
            <ul class="sidemenu">
              <li>
                <a href="gettingstarted.html">Getting started</a>
              </li>
              <li>
                <a href="apartmentstateinfo.html">STA ApartmentState</a>
              </li>
              <li>
                <a href="htmlelementmapping.html">HTML mapping list</a>
              </li>
              <li>
                <a href="roadmap.html">Roadmap</a>
              </li>
              <li>
                <a href="faq.html">FAQ</a>
              </li>
            </ul>
          </div>
        </div><!-- content-wrap ends here -->
      </div><!-- footer starts here -->
      <div id="footer">
        <div class="footer-left" style="WIDTH: 50%; HEIGHT: 37px">
          <p class="align-left">
            © 2007 <strong>Jeroen van Menen</strong> | Design by <a href=
            "http://www.styleshout.com/">styleshout</a>
          </p>
        </div>
        <div class="footer-right" style="WIDTH: 40%; HEIGHT: 54px">
          <p class="align-right">
            <a href="index.html">Home</a> |  <a href=
            "http://sourceforge.net/projects/watin/">WatiN on
            SourceForge</a> |  <a href=
            "http://sourceforge.net/export/rss2_project.php?group_id=167632">RSS
            Feed</a>s
          </p>
          <p class="align-right">
            <a href="http://sourceforge.net"><img border="0" width="125"
            height="37" id="_x0000_i1025" src=
            "http://sflogo.sourceforge.net/sflogo.php?group_id=167632&amp;type=2"
            alt="SourceForge.net Logo" name="_x0000_i1025" /></a>
          </p>
        </div>
      </div><!-- footer ends here -->
      <!-- wrap ends here -->
    </div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3606670-2");
pageTracker._initData();
pageTracker._trackPageview();
</script>

  </body>
</html>
